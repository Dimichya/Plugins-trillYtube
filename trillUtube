

var YouTubePlayer = {
  init: function(videoId, containerId) {
    this.videoId = videoId;
    this.containerId = containerId;
    this.player = null;
    this.firstPlay = false;
    this.autoStopTimeout = null;
    this.isVideoPlaying = false;
    this.isVideoPause = false;
    this.hideTime = 120000; // 2 min
    this.hideBodyTime = 10000; // 5 sec
    this.enabled = null;

    this.bindEvents();
  },

  bindEvents: function() {
    var _this = this;

    Lampa.Listener.follow('full', function(e) {
      if (e.type === 'complite') _this.addVideo(e.data.videos);
    });

    Lampa.Listener.follow('activity', function (e) { 
      var enabled = Lampa.Controller.enabled();
      if (e.type == 'start') _this.enabled = enabled;
    });

    Navigator.follow('focus', function(event) {
      _this.enabled = Lampa.Controller.enabled();
      var el = event.elem.classList.contains('full-start__button');
      if (_this.firstPlay && _this.enabled.name !== "full_start") {
        _this.firstPlay = false;
        console.log('Modss', 'trailer', 'init', 'focus', 'full_start', _this.firstPlay);
        _this.removePlayer('not focus');
      }

      if (el) {
        setTimeout(function() {
          if (_this.isVideoPause && _this.player && _this.enabled.name === "full_start") {
          _this.player.playVideo();
          _this.isVideoPause = false;
          }
          
          if (!_this.isVideoPlaying && _this.videoId && !Lampa.Player.opened() && !_this.firstPlay && Lampa.Activity.active().activity.render().find('.' + _this.containerId).length === 0 && _this.enabled && _this.enabled.name === "full_start") {
            _this.removePlayer('new card');
            console.log('Modss', 'trailer', 'init', 'startPlayer');
            //Lampa.Player.play({youtube: true, url: 'https://www.youtube.com/watch?v=uLrlLDLJpMo', title: ''})
            _this.startPlayer();
          }
        }, 500);
      } else {
        if (["console-tabs", "console-body", "menu", "head", "full_reviews", "full_episodes"].indexOf(_this.enabled.name) === -1) _this.removePlayer('enabled controller - ' + _this.enabled.name);
      }
    });
  },

  addVideo: function(videoData) {
    console.log('Modss', 'trailer', 'init', 'addVideo', videoData);
    if (videoData && videoData.results && videoData.results[0]) {
      var index = videoData.results.findIndex(function(video) {
        return ((!video.official || video.official) && video.iso_639_1 === 'ru') || 
        (video.name.toLowerCase().indexOf('official trailer') !== -1 && video.official === true) || 
        (video.name.toLowerCase().indexOf('trailer') !== -1) || 
        (video.official || !video.official);
      });

      console.log('Modss', 'trailer', 'init', 'addVideo', 'find', videoData.results[index]);

      if (index !== -1) {
        this.videoId = videoData.results[index].key;
      } else this.videoId = null;
        
      if (videoData.results.length > 1)  this.videoData = videoData.results;
    }
  },
  tryPlayNextVideo: function() {
    var officialTrailerIndex = this.videoData.findIndex(function(video) {
      return video.name.toLowerCase().indexOf('official') !== -1;
    });

    if (officialTrailerIndex !== -1) {
      console.log('Modss', 'trailer', 'next','start official trailer', this.videoId);
      this.videoId = this.videoData[officialTrailerIndex].key;
      this.startPlayer();
    } else if (this.videoData.length >= 1) {
      console.log('Modss', 'trailer', 'start next', this.videoId);
      this.videoId = this.videoData[1].key;
      this.startPlayer();
    } else {
      console.log('Modss', 'trailer', 'Не удалось запустить ни один видеоролик');
      this.removePlayer('not found video');
    }
  },
  startPlayer: function() {
    var self = this;
    var loadYouTubePlayer = function() {
      if (typeof YT === 'undefined' || !YT.Player) {
        setTimeout(loadYouTubePlayer, 100);
        return;
      }
      console.log('Modss', 'trailer', 'add Player ID: ', self.videoId);

      // Инициализируем YouTube-плеер
      self.player = new YT.Player(self.containerId, {
          height: (window.innerHeight + 600) * 2,
          width: window.innerWidth * 2,
          playerVars: { 
            'controls': 0,
            'showinfo': 0,
            'autohide': 1,
            'modestbranding': 1,
            'autoplay': 1,
            'disablekb': 1,
            'fs': 0,
            'enablejsapi': 1,
            'playsinline': 1,
            'mute': 1,
            'rel': 0,
            'loop': 0,
            'suggestedQuality': 'hd1080',
            'setPlaybackQuality': 'hd1080'
        },
        videoId: self.videoId,
        events: {
          'onReady': function(event) {
            self.onPlayerReady(event);
          },
          'onStateChange': function(event) {
            self.onPlayerStateChange(event);
          },
          'onPlaybackQualityChange': function(event) {
            self.onPlaybackQualityChange(event);
          },
          'onError': function(event) {
            self.onPlayerError(event);
          }
        }
      });

      self.startAutoStopTimer();
    };
    
    // Добавляем контейнер с плеером на страницу
    var html = $('<div class="' + this.containerId + '"><div class="player-video__youtube-player" id="' + this.containerId + '"></div></div>');
    //Lampa.Activity.active().activity.render().find('.full-start-new').prepend(html);

    let object  = $('<div class="'+this.containerId+'">'+
                      '<div class="player-video__youtube-player" id="'+this.containerId+'"></div>'+
                    '</div>');
    if (Lampa.Platform.tv() || Lampa.Platform.get() == 'android' || Lampa.Platform.get() == 'noname') $('body').append(object[0]);
    else Lampa.Activity.active().activity.render().find('.full-start-new').prepend(object);

    if (window.YT) loadYouTubePlayer(); else {
      console.log('Modss', 'trailer', 'get api YouTubePlayer');
      $.getScript('https://www.youtube.com/iframe_api', loadYouTubePlayer);
    }
  },
  onPlayerReady: function(event) {
    var cont = Lampa.Activity.active().activity.render().find('.' + this.containerId).length && Lampa.Activity.active().activity.render().find('.' + this.containerId) || $('body').find('.' + this.containerId);
    $(cont).css({opacity: 1, transition: 'opacity 2s ease-in-out'});

    //Lampa.Noty.show('YouTube play - ' + this.videoId);
    console.log('Modss', 'trailer', 'ready', 'Start to play');
    
    try { 
       this.player.playVideo();
       if (!Lampa.Platform.is('apple')) event.target.unMute();
       this.isVideoPlaying = true;
       this.hidePoster();
     } catch(error) {
        console.log('Modss', 'trailer', 'ready', 'error: ', error);
     }
  },
  onPlayerStateChange: function(event) {
    switch (event.data) {
      case YT.PlayerState.PLAYING:
        console.log('Modss', 'trailer', 'Video playing');
        this.fullScreen();
        break;
      case YT.PlayerState.ENDED:
        console.log('Modss', 'trailer', 'Video End');
        this.removePlayer();
        break;
      case YT.PlayerState.BUFFERING:
        console.log('Modss', 'trailer', 'set Quality 1080');
        event.target.setPlaybackQuality('hd1080');
        break;
      case -1:
        console.log('Modss', 'trailer', 'Video not ready');
        break;
      default:
        console.log('Modss', 'trailer', 'other', event.data);
        break;
    }
  },
  onPlaybackQualityChange: function(event) {
     console.log('Modss', 'trailer', 'quality', this.player.getPlaybackQuality())
  },
  onPlayerError: function(event) {
    switch (event.data) {
           case 2:
               console.log('Modss', 'trailer', "Неправильный ID видео.");
               this.removePlayer(event.data);
               break;
           case 100:
               console.log('Modss', 'trailer', "Видео не доступно для встраивания, пробуем другое.");
               this.removePlayer(event.data);
               this.tryPlayNextVideo();
               break;
           case 101:
           case 150:
                this.removePlayer(event.data);
               console.log('Modss', 'trailer', "Владелец видео запретил его воспроизведение, пробуем другое.");
               this.tryPlayNextVideo();
               break;
           default:
               console.log('Modss', 'trailer', "Произошла неизвестная ошибка:", event.data);
               this.removePlayer(event.data);
       }
  },
  removePlayer: function(hide) {
    if (this.player) {
      if (typeof hide == 'string' && hide.indexOf('full_descr') >= 0) {
        console.log('Modss', 'trailer', 'Paused', hide);
        this.isVideoPause = true;
        this.player.pauseVideo();
      } else {
        //Lampa.Noty.show('YouTube player delete ' + hide);
        try {
          console.log('Modss', 'trailer', 'Destroy', hide);
          this.player.destroy();
          $('.' + this.containerId).remove();
          this.fadeOut(false, false, true);
          this.isVideoPlaying = false;
          this.isVideoPause = false;
        } catch (error) {
          console.error('Error stopping YouTube player:', error);
        }
        this.player = null;
        this.clearAutoStopTimer();
        if (hide !== 'new card') this.hidePoster();
      }
    }
  },
  startAutoStopTimer: function() {
    var self = this;
    this.autoStopTimeout = setTimeout(function() {
      self.removePlayer();
    }, self.hideTime);
  },
  clearAutoStopTimer: function() {
    if (this.autoStopTimeout) {
      clearTimeout(this.autoStopTimeout);
      this.autoStopTimeout = null;
    }
  },
  fullScreen: function() {
    var _self = this;
    if (window.innerWidth >= 768 && this.isVideoPlaying) {
      setTimeout(function (){
        if (!this.isVideoPause) _self.fadeOut(true);
      }, _self.hideBodyTime);
    }
  },
  fadeOut: function(fid, key, rem) {
    var _this = this;
    var element = Lampa.Activity.active().activity.render().find('.full-start-new__body');
    if (!!rem) {
       $('body').toggleClass('card--no-cover', false);
       $(element).css({opacity: 1, transition: 'opacity 1s ease'});
    } else {
    if (element) {
        $(element).css({opacity: fid ? 0 : 1, transition: 'opacity 2s ease'});
        
        if (this.enabled.name == 'full_start') setTimeout(function (){
            $('body').toggleClass('card--no-cover', true);
            $(element).css({opacity: 0, transition: 'opacity 2s ease'});
        }, !_this.isVideoPause ? _this.hideBodyTime : 3000);
        else $('body').toggleClass('card--no-cover', fid);
        
        //Lampa.Noty.show(this.isVideoPause + ' - ' + this.enabled.name)
        
        //Lampa.Noty.show(fid +' _ ' +this.enabled.name +' '+ this.isVideoPause+ ' - '+ (this.isVideoPause && key))
        
        $('body').find('.youtube-trailers').css({
           'z-index': this.enabled.name !== 'full_start' ? -1 : !this.isVideoPause && fid && !key ? 99 : 9
        });
    }
    }
  },
  hidePoster: function() {
    var _self = this;
    var fullStartNew = Lampa.Activity.active().activity.render().find('.full-start-new');
    if (fullStartNew) {
      var fullPoster = fullStartNew.find('.full-start-new__img.full--poster');
      var hasTrailersPlayer = !!fullStartNew.find('.' + this.containerId).length;

      var updateFullPosterVisibility = function() {
        if (window.innerWidth >= 340 && window.innerWidth <= 480 && window.innerHeight > 480) {
          _self.fullScreen();
          $(fullPoster).css({opacity: hasTrailersPlayer ? '0' : '1', transition: hasTrailersPlayer ? 'opacity 1s ease-in-out' : 'none'});
        } else $(fullPoster).css({opacity:1, transition: 'none'});
      };

      Lampa.Keypad.listener.follow('keydown', function (e) {
        setTimeout(function() {
           _self.fadeOut(false, true);
        }, 100);
      });

      window.addEventListener('touchstart', function (e) {
        if (_self.isVideoPlaying) {
          //console.log('touchstart',{e,pl:pl})
          if (_self.player.isMuted()) _self.player.unMute();
          _self.fadeOut(false, false, true);
          if(_self.isVideoPlaying) $(fullPoster).css({opacity:0, transition: 'none'});
        }
      });

      /*window.addEventListener('touchmove', function (e) {
        console.log('touchmove',e)
        _self.fadeOut(false);
        if(_self.isVideoPlaying) $(fullPoster).css({opacity:0, transition: 'none'});
      });*/

      updateFullPosterVisibility();
      window.addEventListener('resize', updateFullPosterVisibility);
    }
  }
};

function add() {

    //YouTubePlayer.init('VIDEO_ID', 'youtube-trailers');
    YouTubePlayer.init('VIDEO_ID', Lampa.Platform.tv() || Lampa.Platform.get() == 'noname' || Lampa.Platform.get() == 'android' ? 'youtube-trailers' : 'trailers-player');
  
    Lampa.Template.add('modss_style', `<style>
.youtube-trailers {
        position: fixed;
        z-index: 9;
        left: 0em;
        right: 0;
        top: 0em;
        width: -webkit-calc(100%);
        width: calc(100%);
        #height: 90vh;
        height: 66%;
}
.youtube-trailers iframe {
  pointer-events: none;
  position: fixed;
  left: 0px;
  right: 0;
  top: -300px;
  border: 0;
  -webkit-transform-origin: left top;
  -moz-transform-origin: left top;
  -ms-transform-origin: left top;
  -o-transform-origin: left top;
  transform-origin: left top;

  -webkit-transform: scale(0.5);
  -moz-transform: scale(0.5);
  -ms-transform: scale(0.5);
  -o-transform: scale(0.5);
  transform: scale(0.5);


        
          -o-object-fit: cover;
          object-fit: cover;
          aspect-ratio: 10/9;
}


      .trailers-player {
        position: fixed;
        left: 0em;
        right: 0;
        top: -5em;
        width: -webkit-calc(100%);
        width: calc(100%);
        #height: 90vh;
        height: 66%;
        z-index: -1;
        opacity: 0;
        -webkit-transition: opacity 0.5s ease-in-out;
        -o-transition: opacity 0.5s ease-in-out;
        transition: opacity 0.5s ease-in-out;
        overflow: hidden;
        pointer-events: none;
        -webkit-mask-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAjCAYAAAA5dzKxAAAD+UlEQVRYhcWZ61IaQRCFz7KAgBgvyfu/XSqVquSXGrlKfjDH/Wh7FowYp6prVthl+5u+TE/b7HY7nWE07/y8Sa53Pc/7vh1leETJtygyKNcDXFPiPf68Te7N4AigMm+LbCSt+2CyVWkwU5lW0lDSqMyUAe5pw/1+xn+3AZjv8rAltpJWRZ4k3ddgaivEVbcyF5LGZZ5AxkVGgBwHuSjie1rMmbUM8qy9NZYF5EnSzwyGKxLdgStupaeSZpLmki7L9ax8Z2Wp/ATfTcs1gWkh6uLxXMSWWRT5HmEy3yaElZsA4ErSlzJfFSBDEYhCMFrQbkmhhzheItBG0m1mGVpigFXzSl4GiJsiBJoDhm41SpT33OrQIoRg4GdQjaQtYTIf9cvGALmSdC3ptshdALK7TYPSYyhNd4pBT4C4yBGMbjjvczO6mF3CMDcF4qukbwXKMAaxO9F1mN36UngcNTBaqx3iS4tfwDQ6Vhfsc3XudQeo6wI6U5ehsnQbE0vfFnBsHGTbWszQMnYzxwxh6GbX6qzi9Eqlszj4V4h09MUMYZwAZupc7UsQBz1dK1P87BCEiS8iTM06huLewoDnHpGNsygfR4wZXxOEpQo3vSmEwd6q35U+bBwrNOPGaZeLe4djhGXIfx81V8iyW7QWhWn200aEeUtK7CvTP2VEmOykxgMQa6It/n7W4TnjU0bNzaLyLrk3ktZFfJZYl88N6Gfjb304JBMAVzZawRAr7c8QC+3PEC6/J+rSfG1nj8Xi2d3RMD5v74J4tQ1iiMciD+rOIwP8Fnd/gmTl/NmghgHEL6F70a0M8iDpXl2J75RsSxouljRxPyPkWWA4ai5mq/xRZw0Xk2151uArHRaa8bCVVcseZ6vNTnGxsfYWoaIEWWpf3hiW55ZagyOz2LthIpAzWFtghtpbhhulQWi5ubqzPSuE2iHt2AnTevWNRuibxQTwchTVfsVZATCwDeys9qjX538XqKNw7VqPTRJaK2tmZMMJZ5PVZhmQ44YrFTskTzqsoGvNDAPacuze0GpZRvTMfcu6rGLMNPjSD24rwLaKYR7VHQ9i78xCwKkO+2zs1mRNjgzGC7qT9DuLmbj6NRC74FpdvFghWoBVNq1AkClmPkv3i3uUF9M6vOqbUWEFmCxtO4NFV7EibCcxGRCMCxDdk41Bbsp8/6Lo8KMWM9xEXUTGTOcfG5Yfi31jukmtH51ZjgtTg4n730LSr6bnXxpxM4vNiTbMgyN/sxfHA59BY1MwdncyGHvGUtJ9H0wGFEuRmKqznT37LD4bU3/ce+J2QCDL8hhMDa5vjgXlKeVKtlBZPZdV9i9x/NZ/NkXyU1cigzilaq59l+rxF+5FNzBsTB9XAAAAAElFTkSuQmCC);
        mask-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAjCAYAAAA5dzKxAAAD+UlEQVRYhcWZ61IaQRCFz7KAgBgvyfu/XSqVquSXGrlKfjDH/Wh7FowYp6prVthl+5u+TE/b7HY7nWE07/y8Sa53Pc/7vh1leETJtygyKNcDXFPiPf68Te7N4AigMm+LbCSt+2CyVWkwU5lW0lDSqMyUAe5pw/1+xn+3AZjv8rAltpJWRZ4k3ddgaivEVbcyF5LGZZ5AxkVGgBwHuSjie1rMmbUM8qy9NZYF5EnSzwyGKxLdgStupaeSZpLmki7L9ax8Z2Wp/ATfTcs1gWkh6uLxXMSWWRT5HmEy3yaElZsA4ErSlzJfFSBDEYhCMFrQbkmhhzheItBG0m1mGVpigFXzSl4GiJsiBJoDhm41SpT33OrQIoRg4GdQjaQtYTIf9cvGALmSdC3ptshdALK7TYPSYyhNd4pBT4C4yBGMbjjvczO6mF3CMDcF4qukbwXKMAaxO9F1mN36UngcNTBaqx3iS4tfwDQ6Vhfsc3XudQeo6wI6U5ehsnQbE0vfFnBsHGTbWszQMnYzxwxh6GbX6qzi9Eqlszj4V4h09MUMYZwAZupc7UsQBz1dK1P87BCEiS8iTM06huLewoDnHpGNsygfR4wZXxOEpQo3vSmEwd6q35U+bBwrNOPGaZeLe4djhGXIfx81V8iyW7QWhWn200aEeUtK7CvTP2VEmOykxgMQa6It/n7W4TnjU0bNzaLyLrk3ktZFfJZYl88N6Gfjb304JBMAVzZawRAr7c8QC+3PEC6/J+rSfG1nj8Xi2d3RMD5v74J4tQ1iiMciD+rOIwP8Fnd/gmTl/NmghgHEL6F70a0M8iDpXl2J75RsSxouljRxPyPkWWA4ai5mq/xRZw0Xk2151uArHRaa8bCVVcseZ6vNTnGxsfYWoaIEWWpf3hiW55ZagyOz2LthIpAzWFtghtpbhhulQWi5ubqzPSuE2iHt2AnTevWNRuibxQTwchTVfsVZATCwDeys9qjX538XqKNw7VqPTRJaK2tmZMMJZ5PVZhmQ44YrFTskTzqsoGvNDAPacuze0GpZRvTMfcu6rGLMNPjSD24rwLaKYR7VHQ9i78xCwKkO+2zs1mRNjgzGC7qT9DuLmbj6NRC74FpdvFghWoBVNq1AkClmPkv3i3uUF9M6vOqbUWEFmCxtO4NFV7EibCcxGRCMCxDdk41Bbsp8/6Lo8KMWM9xEXUTGTOcfG5Yfi31jukmtH51ZjgtTg4n730LSr6bnXxpxM4vNiTbMgyN/sxfHA59BY1MwdncyGHvGUtJ9H0wGFEuRmKqznT37LD4bU3/ce+J2QCDL8hhMDa5vjgXlKeVKtlBZPZdV9i9x/NZ/NkXyU1cigzilaq59l+rxF+5FNzBsTB9XAAAAAElFTkSuQmCC);
        -webkit-mask-size: 300% 130%;
        mask-size: 300% 80%;
        -webkit-mask-position: 70% 10%;
        mask-position: 70% 0%;
        -webkit-mask-repeat: no-repeat;
        mask-repeat: no-repeat;
      }

       .trailers-player iframe, .trailers-player video {
          position: absolute;
          top: 40%;
          left: 0;
          width: 100%;
          height: auto;
          -webkit-transform: translateY(-50%);
              -ms-transform: translateY(-50%);
              -o-transform: translateY(-50%);
                  transform: translateY(-50%);
          -o-object-fit: cover;
          object-fit: cover;
          aspect-ratio: 10/9;
          pointer-events: none;
      }


      .trailers-player1::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: -webkit-radial-gradient(0% 100%, circle, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.5) 30%, rgba(0, 0, 0, 0.3) 60%, rgba(0, 0, 0, 0) 100%);
        background: -o-radial-gradient(0% 100%, circle, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.5) 30%, rgba(0, 0, 0, 0.3) 60%, rgba(0, 0, 0, 0) 100%);
        background: radial-gradient(circle at 0% 100%, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.5) 30%, rgba(0, 0, 0, 0.3) 60%, rgba(0, 0, 0, 0) 100%);
        -webkit-filter: blur(50px);
                filter: blur(50px);
        z-index: 3;
      }
      

      @media screen and (max-width: 1024px) {
        .trailers-player iframe, .trailers-player video {
          top: 23% !important;
          aspect-ratio: 10 / 9;
        }
        
        .trailers-player {
          left: 10em;
          height: 35%;
          top: -1em;
          -webkit-mask-size: 100% 69%;
          mask-size: 100% 46%;
          -webkit-mask-position: 100% 0%;
          mask-position: 100% 7%;
        }
        @media screen and (min-height: 695px) {
          .trailers-player {
            left: 0em;
            height: 100%;
            width: 100%;
            top: -22em;
            -webkit-mask-size: 150% 32%;
            mask-size: 150% 32%;
            -webkit-mask-position: 100% 6%;
            mask-position: 100% 6%;
          }
        }
      }
      @media screen and (max-width: 920px) {
        .trailers-player iframe, .trailers-player video {
          top: 23% !important;
          aspect-ratio: 10 / 9;
        }
        
        .trailers-player {
          left: -10em;
          height: 35%;
          top: -1em;
          -webkit-mask-size: 100% 69%;
          mask-size: 100% 46%;
          -webkit-mask-position: 100% 0%;
          mask-position: 100% 7%;
        }


   
        @media screen and (min-height: 695px) {
          .trailers-player {
            left: 0em;
            height: 100%;
            width: 100%;
            top: -20em;
            -webkit-mask-size: 150% 32%;
            mask-size: 150% 32%;
            -webkit-mask-position: 100% 6%;
            mask-position: 100% 6%;
          }
          
        }
      }
      @media screen and (max-width: 832px) {
        .trailers-player iframe, .trailers-player video {
            top: 23% !important;
            #aspect-ratio: 21 / 9;
        }
        .orientation--landscape .trailers-player iframe,.orientation--landscape  .trailers-player video {
            top: 9% !important;
            aspect-ratio: 16 / 9;
        }
        
        .trailers-player {
          left: 10em;
          height: 35%;
          top: -6em;
          -webkit-mask-size: 100% 69%;
          mask-size: 100% 69%;
          -webkit-mask-position: 100% 0%;
          mask-position: 100% 0%;
        }

        @media screen and (min-height: 1180px) {
          .trailers-player {
            left: 0em;
            height: 58%;
            width: 100%;
            top: -7em;
            -webkit-mask-size: 101% 32%;
            mask-size: 200% 32%;
            -webkit-mask-position: 100% 6%;
            mask-position: 100% 6%;
          }
        }

        .orientation--landscape .trailers-player1 {
          left: -10em;
          height: 118%;
          -webkit-mask-size: 80% 13%;
          mask-size: 80% 13%;
          -webkit-mask-position: 85% 3%;
          mask-position: 85% 3%;
        }

        .orientation--landscape .trailers-player {
            left: 0em;
            width: 100%;
            height: 100%;
            top: -5em;
            -webkit-mask-size: 300% 18%;
            mask-size: 300% 18%;
            -webkit-mask-position: 100% 1%;
            mask-position: 100% 1%;
        }

        @media screen and (min-height: 695px) {
          .orientation--landscape .trailers-player {
            left: 10em;
            height: 200%;
            width: 100%;
            top: -3em;
            -webkit-mask-size: 100% 32%;
            mask-size: 100% 32%;
            -webkit-mask-position: 100% -10%;
            mask-position: 100% -10%;
          }
        }
      }
      @media screen and (max-width: 780px) {
        .trailers-player iframe, .trailers-player video {
          top: 23% !important;
          aspect-ratio: 10 / 9;
        }
        
        .trailers-player {
          left: 10em;
          height: 35%;
          top: -1em;
          -webkit-mask-size: 100% 69%;
          mask-size: 100% 46%;
          -webkit-mask-position: 100% 0%;
          mask-position: 100% 7%;
        }
        @media screen and (min-height: 695px) {
          .trailers-player {
            left: 0em;
            height: 40%;
            width: 100%;
            top: -2em;
            -webkit-mask-size: 200% 60%;
            mask-size: 200% 60%;
            -webkit-mask-position: 100% -15%;
            mask-position: 100% -15%;
          }
        }
      }
      @media screen and (max-width: 580px) {
          .trailers-player iframe, .trailers-player video {
              top: 34% !important;
          }
      }

      

      @media screen and (max-width: 431px) {
          .trailers-player1 {
            height: 40%;
            top: -12em;
            -webkit-mask-size: 100% 25%;
            mask-size: 100% 22%;
            -webkit-mask-position: 0% 17%;
            mask-position: 0% 19%;
          }

          .trailers-player {
            height: 23%;
            top: 0em;
            left: 0;
            -webkit-mask-size: 300% 50%;
            mask-size: 300% 50%;
            -webkit-mask-position: 100% 0%;
            mask-position: 100% 0%;
          }
          
          .trailers-player iframe, .trailers-player video {
              top: 25% !important;
              aspect-ratio: 10 / 9;
          }
      }
      
      @media screen and (max-width: 400px) {
          .trailers-player iframe, .trailers-player video {
            top: 5% !important;
          }
          .trailers-player {
            left: 0em;
            height: 100%;
            width: 100%;
            top: 0em;
            -webkit-mask-size: 240% 10%;
            mask-size: 240% 10%;
            -webkit-mask-position: 100% 0%;
            mask-position: 100% 0%;
          }
      }

      </style>`);
    $('body').append(Lampa.Template.get('modss_style', {}, true));
}

if (window.appready) add(); else {
    Lampa.Listener.follow('app', function (e) {
        if (e.type == 'ready') add();
    });
}
